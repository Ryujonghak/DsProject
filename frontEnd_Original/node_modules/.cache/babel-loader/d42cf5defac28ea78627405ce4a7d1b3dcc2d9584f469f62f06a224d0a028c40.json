{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/* eslint-disable */\n// import axios from \"axios\";   // 프로필이미지 업로드\nimport custom from \"@/assets/js/custom\";\nimport userService from \"@/services/user.service\";\nimport ReservationDataService from \"@/services/ReservationDataService\";\nexport default {\n  // data: () => ({\n  //   images: \"\",\n  // }),\n  data() {\n    return {\n      CurrentUser: {\n        email: \"\",\n        password: \"\",\n        username: \"\",\n        phone: null,\n        year: null,\n        month: null,\n        day: null,\n        name: \"\",\n        answer: \"\" // 비번확인용 정답\n      },\n\n      message: \"\",\n      watchedMovie: [],\n      // 예매한 영화\n      watchedMovieTotalCount: 0,\n      // 본 영화 갯수\n      emptyArchive: true,\n      // 아카이브 없는지 체크\n\n      // 예매 테이블 추가\n      unbooking: false,\n      //페이징을 위한 변수 정의\n      page: 1,\n      count: 0,\n      pageSize: 5,\n      pageSizes: [5, 10, 15]\n    };\n  },\n  methods: {\n    getUser(username) {\n      // 종학이 백엔드 데이터 받는 함수\n      username = this.$store.state.auth.user.username;\n      // username = \"forbob\";\n      console.log(username);\n      userService.getUserUsername(username).then(response => {\n        this.CurrentUser = {\n          email: response.data.email,\n          password: response.data.password,\n          username: response.data.username,\n          phone: response.data.phone,\n          year: response.data.year,\n          month: response.data.month,\n          day: response.data.day,\n          name: response.data.name,\n          answer: response.data.answer\n        };\n        console.log(this.CurrentUser);\n        // console.log(response.data);\n      }).catch(err => console.log(err));\n    },\n    // TODO: 예매한 영화 가져오기\n    getWatchedMovie() {\n      // 본 영화 전체 조회 요청\n      ReservationDataService.getRespage(this.$store.state.auth.user.username, this.page - 1, this.pageSize).then(response => {\n        this.watchedMovie = response.data;\n        console.log(\"this.watchedMovie\", this.watchedMovie);\n        console.log(response.data);\n        this.findArchive(); // 예매내역(아카이브) 확인함수 추가\n\n        this.watchedMovieTotalCount = response.data.totalItems;\n        console.log(\"this.watchedMovieTotalCount\", this.watchedMovieTotalCount);\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    findArchive() {\n      if (this.watchedMovie.length == 0) {\n        this.emptyArchive = true;\n      } else {\n        this.emptyArchive = false;\n      }\n      console.log(\"findArchive\", this.watchedMovie);\n    },\n    // TODO: 예매번호 티켓예매취소 함수 FIXME:\n    deleteTicket(reservno) {\n      ReservationDataService.delete(reservno).then(response => {\n        console.log(response.data);\n        alert(\"예매내역이 삭제되었습니다.\");\n\n        // this.getQna();\n        // this.$router.push(\"/mypage\");\n        this.getWatchedMovie();\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    // 로그아웃 함수 -> 공통함수 호출\n    logout() {\n      // this.$store.dispatch(\"모듈명/함수명\")\n      this.$store.dispatch(\"auth/logout\"); // 공통함수 logout 호출\n      this.$router.push(\"/\"); // 강제 홈페이지로 이동\n    },\n\n    // 페이지 출력 갯수 변경\n    handlePageChange(value) {\n      this.page = value;\n      this.getQna();\n    }\n  },\n  // created가 mounted보다 더 빨리 실행됨. 데이터 들어가기전에 떠야하는건 created에 넣어야 함\n  mounted() {\n    custom();\n    this.getUser(); // 종학이 백엔드 데이터\n    this.getWatchedMovie(); // 예매내역\n  }\n};","map":{"version":3,"mappings":";AAiQA;AACA;AACA;AACA;AACA;AAEA;EACA;EACA;EACA;EACAA;IACA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;;MACAC;MAEAC;MAAA;MACAC;MAAA;MACAC;MAAA;;MAEA;MACAC;MAEA;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;MACAjB;MACA;MACAkB;MACAC,YACAC,0BACAC;QACA;UACAvB;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;QACA;QACAY;QACA;MACA,GACAI;IACA;IAEA;IACAC;MACA;MACAC,sGACAH;QACA;QACAH;QACAA;QAEA;;QAEA;QACAA;MACA,GACAI;QACAJ;MACA;IACA;IAEAO;MACA;QACA;MACA;QACA;MACA;MACAP;IACA;IAEA;IACAQ;MACAF,wCACAH;QACAH;QACAS;;QAEA;QACA;QACA;MACA,GACAL;QACAJ;MACA;IACA;IAEA;IACAU;MACA;MACA;MACA;IACA;;IAEA;IACAC;MACA;MACA;IACA;EACA;EACA;EACAC;IACAC;IACA;IACA;EACA;AACA","names":["data","CurrentUser","email","password","username","phone","year","month","day","name","answer","message","watchedMovie","watchedMovieTotalCount","emptyArchive","unbooking","page","count","pageSize","pageSizes","methods","getUser","console","userService","getUserUsername","then","catch","getWatchedMovie","ReservationDataService","findArchive","deleteTicket","alert","logout","handlePageChange","mounted","custom"],"sourceRoot":"src/components/myPage","sources":["TicketCom.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!--preloading-->\r\n    <!-- <div id=\"preloader\">\r\n      <img class=\"logo\" src=\"images/logo1.png\" alt=\"\" width=\"119\" height=\"58\" />\r\n      <div id=\"status\">\r\n        <span></span>\r\n        <span></span>\r\n      </div>\r\n    </div> -->\r\n\r\n    <!-- 상단 페이지 제목 -->\r\n    <div class=\"hero user-hero\">\r\n      <div class=\"container\">\r\n        <div class=\"row\">\r\n          <div class=\"col-md-12\">\r\n            <div class=\"hero-ct\">\r\n              <h1>{{ CurrentUser.name }}’s ticket</h1>\r\n              <ul class=\"breadcumb\">\r\n                <li class=\"active\">\r\n                  <router-link to=\"/\">Home</router-link>\r\n                </li>\r\n                <li><span class=\"ion-ios-arrow-right\"></span>MY TICKET</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"page-single\">\r\n      <div class=\"container\">\r\n        <div class=\"row ipad-width\">\r\n          <!-- todo: 이부분 나브 다른 Mypage 컴포넌트들 공통 -->\r\n          <!-- 공통 왼쪽 메뉴 시작 -->\r\n          <div class=\"col-md-3 col-sm-12 col-xs-12\">\r\n            <div class=\"user-information\">\r\n              <div class=\"user-img\">\r\n                <!-- src=\"images/uploads/user-img.png\" -->\r\n                <img\r\n                  class=\"profileImg\"\r\n                  src=\"@/assets/images_choi/Views/choi/MovieDetail/user.png\"\r\n                  alt=\"\"\r\n                />\r\n                <br />\r\n              </div>\r\n              <div class=\"user-fav\">\r\n                <ul>\r\n                  <li class=\"active\">\r\n                    <router-link to=\"\">프로필</router-link>\r\n                  </li>\r\n                  <!-- 프로필 로그인 정보 표시 시작-->\r\n                  <li style=\"color: white\">\r\n                    <strong style=\"color: white\">이름 </strong>\r\n                    <label>{{ CurrentUser.name }}</label>\r\n                  </li>\r\n                  <li style=\"color: white\">\r\n                    <strong style=\"color: white\">아이디 </strong>\r\n                    <label>{{ CurrentUser.username }}</label>\r\n                  </li>\r\n                  <!-- 프로필 로그인 정보 표시 끝 -->\r\n                </ul>\r\n              </div>\r\n              <div class=\"user-fav\">\r\n                <p>Account Details</p>\r\n                <ul>\r\n                  <li>\r\n                    <router-link to=\"/mypage\">내정보</router-link>\r\n                  </li>\r\n                  <li class=\"active\">\r\n                    <router-link to=\"/myticket\">예매내역</router-link>\r\n                  </li>\r\n                  <li>\r\n                    <router-link to=\"/mywish\">찜한 영화</router-link>\r\n                  </li>\r\n                  <li>\r\n                    <router-link to=\"/myqna\">나의 문의내역</router-link>\r\n                  </li>\r\n                  <li>\r\n                    <router-link to=\"/myprofile\">개인정보 수정</router-link>\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n              <div class=\"user-fav\">\r\n                <p>Others</p>\r\n                <ul>\r\n                  <!--                  <li><a href=\"#\">Log out</a></li>-->\r\n                  <li><a href=\"#\" @click.prevent=\"logout\">Log out</a></li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!-- 공통 왼쪽 메뉴 끝 -->\r\n\r\n        <!-- 오른쪽 본문 내용 -->\r\n        <div class=\"col-md-9 col-sm-12 col-xs-12\">\r\n            <div class=\"topbar-filter user\">\r\n              <p class=\"mytitle\">나의 예매내역 <span>{{ watchedMovieTotalCount }}</span> in total</p>\r\n              <a href=\"/myticket\" class=\"grid\"\r\n                ><i class=\"ion-grid\"></i\r\n              ></a>\r\n              <!-- <select>\r\n                <option value=\"range\">-- 2022년 --</option>\r\n                <option value=\"saab\">-- 2021년 --</option>\r\n              </select> -->\r\n            </div>\r\n\r\n            <!-- TODO: v-show 걸어야 함! -->\r\n            <div v-show=\"unbooking\">\r\n              <h3>예매내역이 없습니다.</h3>\r\n            </div>\r\n\r\n            <!-- 예매내역 -->\r\n            <!-- TODO: v-show 걸어야 함! -->\r\n            <div v-show=\"!unbooking\">\r\n              <!-- <div> -->\r\n              <div class=\"page-single userfav_list\">\r\n                <div class=\"container\">\r\n                  <div class=\"row ipad-width2\">\r\n                    <div class=\"col-md-9 col-sm-12 col-xs-12\">\r\n                      <div class=\"flex-wrap-movielist user-fav-list\">\r\n\r\n                        <div v-if=\"emptyArchive == true\" class=\"noArchive\">\r\n                          <h3>예매내역이 없습니다.</h3>\r\n                        </div>\r\n\r\n                        <!-- 예매한 영화 -->\r\n                        <div v-if=\"emptyArchive == false\">\r\n                        <div\r\n                          class=\"movie-item-style-2\" \r\n                          v-for=\"(data, index) in watchedMovie.reservation\"\r\n                          :key=\"index\"\r\n                        >\r\n                          <!-- todo) 이미지크기...  -->\r\n                          <img :src=\"data.posterurln\" alt=\"poster\" />\r\n                          <div class=\"mv-item-infor\">\r\n                            <div>\r\n                              <div class=\"col-xs-8\">\r\n                                <h6>\r\n                                  <router-link\r\n                                    :to=\"'/allMovie/' + data.moviecd\"\r\n                                  >\r\n                                    {{ data.movienm }}\r\n                                  </router-link>\r\n                                </h6>\r\n                                <p class=\"rate\">\r\n                                  <!-- 네이버 평점 -->\r\n                                  <i class=\"ion-android-star\"></i\r\n                                  ><span>{{ data.raiting }}</span> /10\r\n                                </p>\r\n                                <p>감독: {{ data.directors }}</p>\r\n                                <p class=\"describe\">\r\n                                  상영시간: {{ data.showtm }}분\r\n                                  <a>{{ data.watchgradenm }}</a>\r\n                                </p>\r\n                              </div>\r\n                              <div class=\"col-xs-4\">\r\n                                  <div class=\"col-xs-8\">\r\n                                    <div class=\"movie-item-style-2\">\r\n                                      <router-link :to=\"'/archive/' + data.moviecd\">\r\n                                      <!-- <router-link to=\"/archive\"> -->\r\n                                        <!-- <button>리뷰 GO</button> -->\r\n                                      </router-link>\r\n                                    </div>\r\n                                  </div>\r\n                              </div>\r\n                            </div>\r\n\r\n                            <div class=\"col-xs-12\">\r\n                              <p class=\"movie-detail-content col-xs-4\">\r\n                                예매번호\r\n                              </p>\r\n                              <p class=\"col-xs-6\">\r\n                                {{ data.reservno }}\r\n                              </p>\r\n                            </div>\r\n                            <div class=\"col-xs-12\">\r\n                              <p class=\"movie-detail-content col-xs-4\">\r\n                                상영날짜\r\n                              </p>\r\n                              <p class=\"col-xs-6\">{{ data.startday }}</p>\r\n                            </div>\r\n                            <div class=\"col-xs-12\">\r\n                              <p class=\"movie-detail-content col-xs-4\">\r\n                                관람극장\r\n                              </p>\r\n                              <p class=\"col-xs-6\">\r\n                                {{ data.location }}\r\n                                {{ data.screen }}\r\n                                {{ data.starttime }}\r\n                              </p>\r\n                            </div>\r\n                            <div class=\"col-xs-12\">\r\n                              <p class=\"movie-detail-content col-xs-4\">\r\n                                관람좌석\r\n                              </p>\r\n                              <p class=\"col-xs-6\">\r\n                                {{ data.seat }}\r\n                              </p>\r\n                            </div>\r\n                            <p class=\"describe col-xs-12\"></p>\r\n                            <div class=\"col-xs-12\">\r\n                              <p class=\"movie-detail-content col-xs-4\">\r\n                                결제금액\r\n                              </p>\r\n                              <p class=\"col-xs-4\">\r\n                                {{ data.rcount * data.price }}원\r\n                                ( {{ data.rcount }}x{{\r\n                                  data.price\r\n                                }}\r\n                                )\r\n                              </p>\r\n                              <!-- TODO: 예매취소 버튼 - 날짜 지났으면비활성화 -->\r\n                              <div class=\"col-xs-4\">\r\n                                <a href=\"#\" class=\"redbtn\" @click=\"deleteTicket(data.reservno)\"\r\n                                  >예매취소</a\r\n                                >\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- 예매내역 없을 때에만 공백 띄우기 -->\r\n            <div v-show=\"unbooking\">\r\n              <div class=\"blank\"></div>\r\n            </div>\r\n\r\n            <!-- 페이지 -->\r\n            <b-pagination\r\n              v-model=\"page\"\r\n              :total-rows=\"watchedMovie.totalItems\"\r\n              :per-page=\"pageSize\"\r\n              pills\r\n              size=\"sm\"\r\n              prev-text=\"<\"\r\n              next-text=\">\"\r\n              @change=\"handlePageChange\"\r\n            ></b-pagination>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- TODO: 탑버튼 추가 -->\r\n    <a class=\"topbutton\" href=\"#\">\r\n      <img src=\"@/assets/images_jung/iconUp_48.png\" />\r\n    </a>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n/* eslint-disable */\r\n// import axios from \"axios\";   // 프로필이미지 업로드\r\nimport custom from \"@/assets/js/custom\";\r\nimport userService from \"@/services/user.service\";\r\nimport ReservationDataService from \"@/services/ReservationDataService\";\r\n\r\nexport default {\r\n  // data: () => ({\r\n  //   images: \"\",\r\n  // }),\r\n  data() {\r\n    return {\r\n      CurrentUser: {\r\n        email: \"\",\r\n        password: \"\",\r\n        username: \"\",\r\n        phone: null,\r\n        year: null,\r\n        month: null,\r\n        day: null,\r\n        name: \"\",\r\n        answer: \"\", // 비번확인용 정답\r\n      },\r\n      message: \"\",\r\n\r\n      watchedMovie: [],   // 예매한 영화\r\n      watchedMovieTotalCount: 0,  // 본 영화 갯수\r\n      emptyArchive: true, // 아카이브 없는지 체크\r\n\r\n      // 예매 테이블 추가\r\n      unbooking: false,\r\n\r\n      //페이징을 위한 변수 정의\r\n      page: 1,\r\n      count: 0,\r\n      pageSize: 5,\r\n      pageSizes: [5, 10, 15],\r\n    };\r\n  },\r\n  methods: {\r\n    getUser(username) {\r\n      // 종학이 백엔드 데이터 받는 함수\r\n      username = this.$store.state.auth.user.username;\r\n      // username = \"forbob\";\r\n      console.log(username);\r\n      userService\r\n        .getUserUsername(username)\r\n        .then((response) => {\r\n          this.CurrentUser = {\r\n            email: response.data.email,\r\n            password: response.data.password,\r\n            username: response.data.username,\r\n            phone: response.data.phone,\r\n            year: response.data.year,\r\n            month: response.data.month,\r\n            day: response.data.day,\r\n            name: response.data.name,\r\n            answer: response.data.answer,\r\n          };\r\n          console.log(this.CurrentUser);\r\n          // console.log(response.data);\r\n        })\r\n        .catch((err) => console.log(err));\r\n    },\r\n\r\n    // TODO: 예매한 영화 가져오기\r\n    getWatchedMovie() {\r\n     // 본 영화 전체 조회 요청\r\n      ReservationDataService.getRespage(this.$store.state.auth.user.username, this.page -1, this.pageSize)\r\n        .then((response) => {\r\n          this.watchedMovie = response.data;\r\n          console.log(\"this.watchedMovie\", this.watchedMovie);\r\n          console.log(response.data);\r\n          \r\n          this.findArchive();  // 예매내역(아카이브) 확인함수 추가\r\n\r\n          this.watchedMovieTotalCount = response.data.totalItems;\r\n          console.log(\"this.watchedMovieTotalCount\", this.watchedMovieTotalCount);\r\n        })\r\n        .catch((e) => {\r\n          console.log(e);\r\n        });\r\n    },\r\n    \r\n    findArchive() {\r\n      if(this.watchedMovie.length == 0) {\r\n        this.emptyArchive = true;\r\n      } else {\r\n        this.emptyArchive = false;\r\n      }\r\n      console.log(\"findArchive\", this.watchedMovie);\r\n    },\r\n    \r\n    // TODO: 예매번호 티켓예매취소 함수 FIXME:\r\n    deleteTicket(reservno) {\r\n      ReservationDataService.delete(reservno)\r\n        .then((response) => {\r\n          console.log(response.data);\r\n          alert(\"예매내역이 삭제되었습니다.\");\r\n\r\n          // this.getQna();\r\n          // this.$router.push(\"/mypage\");\r\n          this.getWatchedMovie();\r\n        })\r\n        .catch((e) => {\r\n          console.log(e);\r\n        });\r\n    },\r\n\r\n    // 로그아웃 함수 -> 공통함수 호출\r\n    logout() {\r\n      // this.$store.dispatch(\"모듈명/함수명\")\r\n      this.$store.dispatch(\"auth/logout\"); // 공통함수 logout 호출\r\n      this.$router.push(\"/\"); // 강제 홈페이지로 이동\r\n    },\r\n\r\n    // 페이지 출력 갯수 변경\r\n    handlePageChange(value) {\r\n      this.page = value;\r\n      this.getQna();\r\n    },\r\n  },\r\n  // created가 mounted보다 더 빨리 실행됨. 데이터 들어가기전에 떠야하는건 created에 넣어야 함\r\n  mounted() {\r\n    custom();\r\n    this.getUser(); // 종학이 백엔드 데이터\r\n    this.getWatchedMovie(); // 예매내역\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.movie-item-style-2 .mv-item-infor .describe {\r\n  width: 530px;\r\n}\r\n\r\n.movie-item-style-2 {\r\n  padding-top: 20px;\r\n  padding-bottom: 50px;\r\n}\r\n\r\n.blank {\r\n  padding-top: 10%;\r\n}\r\n\r\n.page-single.userfav_list {\r\n  padding: 0px;\r\n}\r\n\r\n/* 예매내역 없음 */\r\n.noArchive{\r\n  color:lightslategray;\r\n}\r\n\r\n/* 배경이미지 : 아리걸로 통일 */\r\n.user-hero {\r\n  background: url(@/assets/images_jung/movie-theater02.jpg) no-repeat;\r\n  /* height: 598px; */\r\n  width: 100%;\r\n}\r\n\r\n/* 마이페이지-프로필 이미지크기 수정 */\r\n.profileImg {\r\n  -ms-interpolation-mode: bicubic;\r\n  border: 0;\r\n  /* height: auto; */\r\n  max-height: 120px;\r\n  /* max-width: 100%; */\r\n  max-width: 120px;\r\n  vertical-align: middle;\r\n}\r\n\r\n.mytitle{\r\n  color: azure;\r\n}\r\n\r\n/* TODO: 탑버튼 추가 */\r\n.topbutton {\r\n  position: fixed;\r\n  bottom: 15px;\r\n  right: 15px;\r\n  width: 40px;\r\n  height: 40px;\r\n  z-index: 1;\r\n  opacity: 0.8;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}